"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var s=0;s<i.length;s++){var n=i[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,i,s){return i&&_defineProperties(t.prototype,i),s&&_defineProperties(t,s),t}function getIntersection(t,i,s,n,e,r,a,o){var h=((t-e)*(r-o)-(i-r)*(e-a))/((t-s)*(r-o)-(i-n)*(e-a)),a=((s-t)*(i-r)-(n-i)*(t-e))/((t-s)*(r-o)-(i-n)*(e-a));return 0<h&&0<a&&a<1?{x:t+h*(s-t),y:i+h*(n-i),t:h}:null}function dist(t,i,s,n){return Math.sqrt((s-t)*(s-t)+(n-i)*(n-i))}var Ray=function(){function t(){_classCallCheck(this,t),this.position={x:0,y:0},this.barriers=[],this.casts=[]}return _createClass(t,[{key:"addBarrier",value:function(t,i,s,n){this.barriers.push({pointA:{x:t,y:i},pointB:{x:s,y:n}})}},{key:"cast",value:function(){this.casts=[];for(var t=0;t<this.barriers.length;t++){var i=this.barriers[t],s=Math.atan2(i.pointA.y-this.position.y,i.pointA.x-this.position.x)-1e-6;this.casts.push({x:this.position.x+Math.cos(s),y:this.position.y+Math.sin(s),angle:s}),s=Math.atan2(i.pointA.y-this.position.y,i.pointA.x-this.position.x)+1e-6,this.casts.push({x:this.position.x+Math.cos(s),y:this.position.y+Math.sin(s),angle:s})}for(t=0;t<this.casts.length;t++){for(var n=this.casts[t],e=void 0,r=Number.MAX_SAFE_INTEGER,a=0;a<this.barriers.length;a++){var o=this.barriers[a],o=getIntersection(this.position.x,this.position.y,n.x,n.y,o.pointA.x,o.pointA.y,o.pointB.x,o.pointB.y);o&&o.t<r&&(r=o.t,e=o)}e&&(n.x=e.x,n.y=e.y)}}},{key:"getShape",value:function(){var t=[];this.casts.sort(function(t,i){return t.angle-i.angle});for(var i=0;i<this.casts.length;i++){var s=this.casts[i];t.push({x:s.x,y:s.y})}return t}}]),t}();module.exports={create:function(){return new Ray}};