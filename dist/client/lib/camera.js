"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function lerp(t,e,i){return i*(e-t)+t}var Camera2D=function(){function i(t,e){_classCallCheck(this,i),e=e||{},this.movement={x:0,y:0},this.viewport={left:0,right:0,top:0,bottom:0,width:0,height:0,scale:[1,1]},this.distance=0,this.context=t||null,this.fieldOfView=e.fieldOfView||Math.PI/4,this.moveSpeed=e.moveSpeed||1,this.zoomSpeed=e.zoomSpeed||1,this.scaleSpeed=e.scaleSpeed||1}return _createClass(i,[{key:"setContext",value:function(t){this.context=t,this.updateViewport()}},{key:"setMoveSpeed",value:function(t){this.moveSpeed=t}},{key:"setZoomSpeed",value:function(t){this.zoomSpeed=t}},{key:"setScaleSpeed",value:function(t){this.scaleSpeed=t}},{key:"begin",value:function(t){"function"==typeof t&&(this.context.save(),this.applyScale(),this.applyTranslation(),t(this),this.context.restore())}},{key:"applyScale",value:function(){this.context.scale(this.viewport.scale[0],this.viewport.scale[1])}},{key:"applyTranslation",value:function(){this.context.translate(-this.viewport.left,-this.viewport.top)}},{key:"updateViewport",value:function(){this.aspectRatio=this.context.canvas.width/this.context.canvas.height,this.viewport.width=lerp(this.viewport.width,this.distance*Math.tan(this.fieldOfView),this.scaleSpeed),this.viewport.height=lerp(this.viewport.height,this.viewport.width/this.aspectRatio,this.scaleSpeed),this.viewport.left=this.movement.x-this.viewport.width/2,this.viewport.top=this.movement.y-this.viewport.height/2,this.viewport.right=this.viewport.left+this.viewport.width,this.viewport.bottom=this.viewport.top+this.viewport.height,this.viewport.scale[0]=this.context.canvas.width/this.viewport.width,this.viewport.scale[1]=this.context.canvas.height/this.viewport.height}},{key:"zoomTo",value:function(t){this.distance=lerp(this.distance,t,this.zoomSpeed),this.updateViewport()}},{key:"moveTo",value:function(t,e){this.movement.x=lerp(this.movement.x,t,this.moveSpeed),this.movement.y=lerp(this.movement.y,e,this.moveSpeed),this.updateViewport()}},{key:"sees",value:function(t,e,i,o){return i=i||0,this.viewport.top<e+(o=o||0)&&this.viewport.right>t-i&&this.viewport.bottom>e-o&&this.viewport.left<t+i}},{key:"screenToWorld",value:function(t,e,i){return i=i||{x:t/this.viewport.scale[0]+this.viewport.left,y:e/this.viewport.scale[1]+this.viewport.top}}},{key:"worldToScreen",value:function(t,e,i){return i=i||{x:(t-this.viewport.left)*this.viewport.scale[0],y:(e-this.viewport.top)*this.viewport.scale[1]}}}]),i}();module.exports={create:function(t,e){return new Camera2D(t,e)}};